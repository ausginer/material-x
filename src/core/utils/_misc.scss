@use 'sass:meta';
@use 'sass:string';
@use '~@fireflysemantics/sass-logger' as logger;
@use '~@sass-fairy/list/list';
@use '../../core/utils/map';

@mixin vars($map) {
  @each $key, $value in $map {
    --_#{$key}: #{$value};
  }
}

@function debug($map) {
  @return logger.pretty-map($map);
}

@function filter-nulls($map) {
  $result: ();

  @each $key, $value in $map {
    @if $value != null {
      $result: map.set($result, $key, $value);
    }
  }

  @return $result;
}

@function -is-unique(
  $extension,
  $-index,
  $-list,
  $original-key,
  $original-value
) {
  @return $original-value != map.get($extension, $original-key);
}
$-is-unique: meta.get-function('-is-unique');

@function extend($map, $extensions...) {
  $result: ();

  @each $key, $value in $map {
    @if list.every($extensions, $-is-unique, $key, $value) {
      $result: map.set($result, $key, $value);
    }
  }

  @return $result;
}

@function append-public-prefix($map, $prefix) {
  $result: ();

  @each $key, $value in $map {
    $result: map.set($result, $key, 'var(--#{$prefix}-#{$key}, #{$value})');
  }

  @return $result;
}
